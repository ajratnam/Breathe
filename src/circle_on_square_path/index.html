<!DOCTYPE html>
<html>
<head>
  <title>Circle Following Square Path (Continuous)</title>
  <style>
    #canvas {
      display: block;
      margin: 0 auto;
      border: 1px solid black;
    }
  </style>
</head>
<body>
  <canvas id="canvas" width="600" height="600"></canvas>

  <script>
    // Get the canvas element
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    // Define circle properties
    const circle = {
      x: 50, // Initial x position
      y: 50, // Initial y position
      radius: 20,
      speed: 100, // Pixels per second
    };

    // Calculate square path properties based on canvas dimensions
    const square = {
      x: (canvas.width - 400) / 2, // Centered x position
      y: (canvas.height - 400) / 2, // Centered y position
      width: 400,
      height: 400
    };

    let animationId; // To keep track of the animation request

    function drawCircle() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the square path
      ctx.strokeRect(square.x, square.y, square.width, square.height);

      // Generate a random color
      const randomColor = `rgb(${Math.floor(Math.random() * 256)}, ${Math.floor(
        Math.random() * 256
      )}, ${Math.floor(Math.random() * 256)})`;

      // Set the circle color
      ctx.fillStyle = randomColor;

      // Draw the circle
      ctx.beginPath();
      ctx.arc(circle.x, circle.y, circle.radius, 0, Math.PI * 2);
      ctx.fill();
      ctx.closePath();
    }

    function animateCircle(timestamp) {
      const progress = (timestamp / 1000) % 16; // Calculate animation progress in seconds

      // Calculate circle position based on progress and square path
      if (progress <= 4) {
        // Move right
        circle.x = square.x + (progress / 4) * square.width;
        circle.y = square.y;
      } else if (progress <= 8) {
        // Move down
        circle.x = square.x + square.width;
        circle.y = square.y + ((progress - 4) / 4) * square.height;
      } else if (progress <= 12) {
        // Move left
        circle.x = square.x + (1 - (progress - 8) / 4) * square.width;
        circle.y = square.y + square.height;
      } else {
        // Move up
        circle.x = square.x;
        circle.y = square.y + (1 - (progress - 12) / 4) * square.height;
      }

      drawCircle();

      // Request next animation frame
      animationId = requestAnimationFrame(animateCircle);
    }

    // Start the animation
    animationId = requestAnimationFrame(animateCircle);

    // Stop the animation when the user closes the webpage
    window.addEventListener('beforeunload', function() {
      cancelAnimationFrame(animationId);
    });
  </script>
</body>
</html>

